<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Spinnerworks</title>
    <style type="text/css">

      canvas {
        border: 1px solid black;
      }

      body {
        margin: 0;
      }


    </style>
  </head>
  <body>
    <canvas></canvas>
    <script >

      // declare constant variables
      const canvas = document.querySelector('canvas');
      const c = canvas.getContext('2d'); // c within canvas is always context
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      const mouse = {
        x: innerWidth / 2,
        y: innerHeight / 2
      }
      
      addEventListener('resize', () => {
        canvas.width = window.innerWidth
        canvas.height = window.innerHeight
        init()
      })
      
      class Spinner {
        constructor(x, y, radius, color, velocity) {
          this.x = x
          this.y = y
          this.radius = radius
          this.color = color
          this.velocity = velocity
        }

        draw() {
          c.beginPath()
          c.arc(this.x, this.y, this.radius, 0, Math.PI * 2, false)
          c.fillStyle = this.color
          c.fill()
          c.closePath()
        }
        update() {
          this.draw()
          this.x += this.velocity.x
          this.y += this.velocity.y
        }
      }
      
      let spinners
      function init() {
        spinners = []
      }

      function animate() {
        requestAnimationFrame(animate)
        c.clearRect(0,0, canvas.width, canvas.height)
        spinners.forEach((spinner) => {
          spinner.update()
        })
      }
      
      init()
      animate()
      addEventListener('click', (event) => {
        mouse.x = event.clientX
        mouse.y = event.clientY
        const particleCount = 400
        const angleIncrement = (Math.PI * 2) / particleCount
        // particles
        for (let i = 0; i < particleCount; i++){
          spinners.push(
            new Spinner(
              mouse.x, mouse.y, 5,  'blue', {
                x: Math.cos(angleIncrement * i) * Math.random(), 
                y: Math.sin(angleIncrement * i) * Math.random()
              }
            ))
          }
        console.log(spinners)
      })

    </script>
  </body>
</html>